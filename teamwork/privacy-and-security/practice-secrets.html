<section class="training">
  <header>
    <h1>Salaisuudet ja historia</h1>
    <p>
      Tässä harjoituksessa näet käytännössä, miksi salaisuuksia ei pidä
      tallentaa Git-repositorioon. Harjoitus tehdään vain
      <em>tekaistulla salaisuudella</em> testirepossa.
    </p>

    <h5>Harjoitus 6 - Salaisuuksien käsittely Gitissä</h5>
    <ol>
      <li>Luo tyhjä testirepositorio tai avaa olemassa oleva testirepositorio
      </li>

      <li>
        Luo tiedosto <em>secrets.txt</em> ja lisää teksti
        <em>API_KEY=DEMO-12345-ABC</em>
      </li>

      <li>
        Tallenna tiedosto versionhallintaan<br />
        <code>git add secrets.txt <br /> </code>
      </li>

      <li>
        Commitoi tiedosto<br />
        <code>git commit -m "Lisää demoavain testitarkoituksiin"</code>
      </li>

      <li>
        Puske muutokset GitHubiin<br />
        <code>git push -u origin main</code>
      </li>

      <li>Tarkista, että tiedosto näkyy repositorion etusivulla</li>

      <li>
        Poista tiedosto manuaalisesti tai komennolla<br />
        <code>git rm secrets.txt </code><br />
      </li>

      <li>
        Kirjaa poisto omaksi commitiksi<br />
        <code>git commit -m "Poista demoavain"</code>
      </li>

      <li>
        Puske muutokset GitHubiin<br />
        <code>git push -u origin main</code>
      </li>

      <li>Tarkista, että tiedostoa ei näy repositorion etusivulla</li>

      <li>
        Etsi tiedosto GitHubin historiasta: etsi selaimella
        <em>Commits-lista</em> → siirry ensimmäiseen
        commit-merkintään → paina <em>Load Diff</em> ja tarkastele diffiä
      </li>

      <div class="note-box margin-right">
        <ul>
          <li class="warning">Poistettu sisältö on yhä nähtävissä historiassa!
          </li>
        </ul>
      </div>

      <li>
        Tarkista myös paikallisesti tiedoston commit-historia ja sen sisältö
        viimeisimmässä commitissa (HEAD~1)<br>
        <code>git log --follow -- secrets.txt</code><br>
        <code>git show HEAD~1:secrets.txt</code><br>
      </li>

      <h5>Lisätehtävä: Luo käsittely salaisuuksille</h5>
      <li>Luo tiedosto <em>.env</em> ja lisää teksti
        <em>API_KEY=DEMO-2222-ASD</em>
      </li>
      <li>Luo .gitignore tiedosto ja lisää siihen rivi<br>
        <code>.env</code>
      </li>

      <li>
        Tarkista ettei .env näy seurattavien tiedostojen listassa komennolla<br>
        <code>git status</code><br>
      </li>

      <li>
        Lisää kaikki muutokset versionhallintaan<br>
        <code>git add .</code>
      </li>

      <li>
        Commitoi muutos<br>
        <code>git commit -m "Lisää ignore-sääntö .env-tiedostolle"</code>
      </li>

      <li>
        Puske muutos GitHubiin<br>
        <code>git push</code>
      </li>

      <li>
        Lopuksi tarkista GitHubissa, ettei .env-tiedosto näy
        repositorion etusivulla
      </li>
    </ol>

    <p>Onnittelut! Nyt tiedät, miksi salaisuudet
      pidetään aina Gitin ulkopuolella ja miksi .gitignore-tiedosto
      sekä .env-tiedostot ovat tärkeä osa turvallista kehitystyötä.
    </p>

    <p class="note-box">
      Muista mitätöidä vuodetut salaisuudet heti. Julkisia GitHub-repositorioita
      skannataan automatisoiduilla työkaluilla, ja salaisuudet voivat päätyä
      vääriin käsiin yllättävän nopeasti.
    </p>

  </header>
</section>